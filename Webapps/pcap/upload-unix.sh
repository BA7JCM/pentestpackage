#!/bin/bash

# Credits: REDD
# TARGET OS: Unix - BASH/Shell Script

FILE_PATH="$1"
EMAIL="$2"

if [ -z "$EMAIL" ]; then
    EMAIL="test@test.com"
fi

SENT_DIR="$(dirname "$FILE_PATH")/sent"
if [ ! -d "$SENT_DIR" ]; then
    mkdir -p "$SENT_DIR"
fi

# Add logging for each step
echo "Processing file: $FILE_PATH"
echo "Using email: $EMAIL"

RESPONSE=$(curl -s -o /dev/null -w "%{http_code}" -X POST -F "email=$EMAIL" -F "file=@$FILE_PATH" https://api.onlinehashcrack.com)

if [ "$RESPONSE" -eq 200 ]; then
    echo "File successfully uploaded"
    mv -f "$FILE_PATH" "$SENT_DIR/$(basename "$FILE_PATH")"
    echo "File moved to: $SENT_DIR/$(basename "$FILE_PATH")"
else
    echo "Failed to upload file: HTTP $RESPONSE"
fi

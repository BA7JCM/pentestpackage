#!/bin/bash

# Determine the width of the IP Address column
max_ip_width=$(awk '{if (length($1) > max) max = length($1);} END {print max;}' $1)

# Determine the width of the Supported SSL/TLS Protocols column
max_protocol_width=$(while IFS=" " read -r IP PORT; do sslscan ${IP}:${PORT} | grep "enabled" | awk '{print $1}'; done < $1 | tr '\n' ' ' | awk '{if (length > max) max = length;} END {print max;}')

echo -e "IP Address $(printf '%*s' ${max_ip_width} '') | Supported SSL/TLS Protocols $(printf '%*s' ${max_protocol_width} '')"
echo -e "$(printf '%-*s' $((max_ip_width + 2)) '----------------')|$(printf '%-*s' $((max_protocol_width + 30)) '-----------------------------')"

while IFS=" " read -r IP PORT; do 
    OUTPUT=$(sslscan ${IP}:${PORT} | grep "enabled" | awk '{print $1}' | tr '\n' ' ')
    COLORED_OUTPUT=""
    for PROTOCOL in $OUTPUT; do
        case "$PROTOCOL" in
            "TLSv1.0"|"TLSv1.1")
                COLORED_OUTPUT+="\033[31m${PROTOCOL}\033[0m "
                ;;
            *)
                COLORED_OUTPUT+="\033[32m${PROTOCOL}\033[0m "
                ;;
        esac
    done
    echo -e "$(printf '%-*s' $((max_ip_width + 2)) "${IP}") | ${COLORED_OUTPUT}"
done < $1


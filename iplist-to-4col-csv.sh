#!/bin/bash

# Display banner
cat << "EOF"
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|P|e|n|t|e|s|t|P|a|c|k|a|g|e|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    Script: IPlist-to-4col-csv.sh
    Author: Leon Teale
    Twitter: @leonteale
    Website: cyberwolf-security.co.uk
    Version: 1.0.0
EOF


USAGE='
Usage: create_ip_csv.sh [filename]
This script reads IP addresses from the specified file and creates a CSV file with 4 IP addresses per row.
'

#Define error messages
missing_ips_file_error="\e[31mError\e[0m: No file supplied."
invalid_option_error="\e[31mInvalid option\e[0m:"

#Check if the IP list file name is provided as an argument
if [ $# -eq 0 ]; then
echo -e "${missing_ips_file_error}"
echo -e "${USAGE}"
exit 1
fi

#Get the IP list file name from the command-line argument
ip_file="$1"

#Check if the IP list file exists and is readable
if [[ ! -f "$ip_file" || ! -r "$ip_file" ]]; then
echo -e "\e[31mError\e[0m: '\e[33m$ip_file\e[0m' is not a readable file or does not exist"
echo -e "${USAGE}"
exit 1
fi

#Read IP addresses from the IP list file
ips=($(cat "$ip_file"))

#Create the output CSV file
output_file="ips.csv"
echo "IP Address 1,IP Address 2,IP Address 3,IP Address 4" > "$output_file"

#Loop through IP addresses and add them to the CSV file
for ((i=0; i<${#ips[@]}; i+=4)); do
echo "${ips[i]},${ips[i+1]},${ips[i+2]},${ips[i+3]}" >> "$output_file"
done

echo "CSV file created at $output_file"
